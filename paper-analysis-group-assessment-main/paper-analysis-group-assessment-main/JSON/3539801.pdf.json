{"TYPE": "document", "VALUE": [{"TYPE": "body", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in the SUNDIALS Suite of Nonlinear and Diferential/Algebraic Equation Solvers"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 576, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "DAVID J. GARDNER, Lawrence Livermore National Laboratory, USA DANIEL R. REYNOLDS, Southern Methodist University, USA "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "CAROL S. WOODWARD, Lawrence Livermore National Laboratory, USA CODY J. BALOS, Lawrence Livermore National Laboratory, USA"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 2736, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "In recent years, the SUite of Nonlinear and DIferential/ALgebraic equation Solvers (SUNDIALS) has been redesigned to better enable the use of application-speciic and third-party algebraic solvers and data structures. Throughout this work, we have adhered to speciic guiding principles that minimized the impact to current users while providing maximum lexibility for later evolution of solvers and data structures. The redesign was done through the addition of new linear and nonlinear solvers classes, enhancements to the vector class, and the creation of modern Fortran interfaces. The vast majority of this work has been performed \u0142behind-the-scenes,\u017e with minimal changes to the user interface and no reduction in solver capabilities or performance. These changes allow SUNDIALS users to more easily utilize external solver libraries and create highly customized solvers, enabling greater lexibility on extreme-scale, heterogeneous computational architectures."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 170, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "CCS Concepts: \u00b7 Mathematics of computing \u2192 Solvers; Ordinary diferential equations; Diferential algebraic equations; Nonlinear equations."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Additional Key Words and Phrases: Numerical software, object-oriented design, time integration, nonlinear solvers, high-performance computing"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "INTRODUCTION"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The SUite of Nonlinear and DIferential/ALgebraic equation Solvers (SUNDIALS) [41] is a collection of software packages designed to solve time-dependent and nonlinear equations on large-scale, high performance computing (HPC) systems. The packages have evolved from a multi-decade history of highly eicient solution packages for ordinary diferential equations (ODEs) [13, 38, 39], diferential-algebraic equations (DAEs) [61], nonlinear systems [16, 18], and sensitivity analysis enabled integrators [53, 69]. The SUNDIALS codes take advantage of the many innovations this history and the methods community have delivered in terms of adaptive time step and adaptive order integrators for ODEs and DAEs [17, 19, 36, 37, 47, 50], the combination of Krylov and Newton methods for eicient nonlinear solvers [14, 15, 60], methods and software for sensitivity analysis [21, 32, 53, 56], and efective solver controls for time integrators and nonlinear solvers [20, 40, 42\u015b44]. Over the last two decades the SUNDIALS codes have been used in a number of applications on small to large-scale computing systems [22, 28, 29, 33\u015b35, 52, 57, 74, 77] as well as in other mathematical libraries and frameworks [3\u015b5, 55, 62, 68, 76, 77], garnering more than 120,000 downloads in 2021."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "During this time, the science simulated as well as the software needed to carry out those simulations have grown in complexity as HPC architectures have transitioned from simplistic homogeneous systems to heterogeneous systems (e.g., CPU+GPU). With the trend toward heterogeneity, the object-oriented design of the SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Authors' addresses: D. J. Gardner, C. S. Woodward, and C. J. Balos, Center for Applied Scientiic Computing, Lawrence Livermore National Laboratory, 7000 East Ave, L-561, Livermore, CA 94550; emails: {gardner48, woodward6, balos1}@llnl.gov; D. R. Reynolds, Department of Mathematics, Southern Methodist University, P.O. Box 750156, Dallas, TX 75275; email: reynolds@smu.edu."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM acknowledges that this contribution was authored or co-authored by an employee, contractor, or ailiate of the United States government. As such, the United States government retains a nonexclusive, royalty-free right to publish or reproduce this article, or to allow others to do so, for government purposes only."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 144, "firstLine": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u00a9 2022 Association for Computing Machinery."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 162, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0098-3500/2022/0-ART0 $15.00 "}, {"TYPE": "Break"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 144, "right": 7056, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 92, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "vector structure [41] has enabled incorporating new HPC programming models [49, 63]. However, this design did not extend to other aspects of SUNDIALS. Thus, creating interfaces to utilize new algebraic solver packages targeting large-scale heterogeneous systems would require extensive redundant code with limited extensibility. This paper describes recent enhancements following an object-oriented design to ensure adaptability to new machines and programming environments, allow users to construct architecture-aware and problem-speciic data structures and solvers, ease interoperability with other libraries, and provide greater lexibility to users and for future extensions. The design principles that guided this work have been: assume as little about data layouts as possible; deine interfaces that allow users to provide their own data structures and solvers with little new code; ensure SUNDIALS packages can evolve and change their oferings under these interfaces; produce highly sustainable code; and minimize the impact to current users."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The rest of this paper is organized as follows. The next section gives a brief overview of the SUNDIALS packages and is followed by a discussion of the core SUNDIALS classes. Section 4 describes changes to the vector class and new vector implementations. Sections 5 and 6 discuss new classes for linear and nonlinear solvers, respectively with accompanying demonstration programs. Section 7 overviews the modern, sustainable Fortran 2003 interfaces to SUNDIALS. Lastly, Section 8 gives a summary and next steps for SUNDIALS."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Throughout the text, the presentation of new features and enhancements is generally focused at the level of interfaces and functionality while many of the implementation-speciic details of the contributions are excluded. However, references to detailed descriptions in the SUNDIALS user guides are provided for the interested reader. As the user guide for each SUNDIALS package includes shared text regarding the overall SUNDIALS infrastructure, these citations refer to version 6.2.0 of the CVODE user guide [45]. For details on updating existing codes to the latest SUNDIALS version, see the \u0142Recent Changes\u017e section of the package's user guide and the examples included with each release. The SUNDIALS source code, example programs, and user guides can be obtained from the SUNDIALS web page [71] or GitHub repository [72]."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "2 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNDIALS OVERVIEW"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "This section provides a brief overview of the numerical methods implemented in the six SUNDIALS packages: CVODE, CVODES, IDA, IDAS, ARKODE, and KINSOL. Additional details on each package, with the exception of ARKODE, are available in [41]. As the native vector and matrix derived classes are written for problems in real N-space, the following overview considers problems posed in RN. Problems posed in other spaces (e.g., CN) can be solved using user-deined derived classes."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 172, "right": 144, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "2.1 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "CVODE and CVODES"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "CVODE targets stif and nonstif initial value problems (IVPs) for ODEs in the explicit form"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u02d9y = f (t,y), "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "y(t0) = y0,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 3674, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "where t is the independent variable (e.g., time), the dependent variable is y \u2208 RN, \u02d9y denotes dy/dt, and f : R \u00d7 RN\u2192 RN. CVODE uses variable order and variable step size implicit linear multistep methods in the ixed-leading-coeicient form [19, 47] given by"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 8}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "K1"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 1440, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u03b1n,iyn\u2212i + hn"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "K2"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u03b2n,i f (tn\u2212i,yn\u2212i) = 0,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 26, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "where yn is a computed approximation to y(tn), hn = tn \u2212 tn\u22121 is the time step size, the values K1 and K2 are determined by the method type and order of accuracy, and the coeicients \u03b1n,i and \u03b2n,i are uniquely determined by the method type and order as well as the recent step size history. Adams-Moulton methods of order 1 to 12 are provided for non-stif problems and Backward Diferentiation Formulas (BDF) of order 1 to 5 for stif cases."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 8}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 72, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:3"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Additionally, CVODE supports projection methods [30, 70] for integrating ODE systems with constraints i.e., where the solution must satisfy \u0434(t,y) = 0."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "CVODES [69] is an extension of CVODE for conducting forward or adjoint sensitivity analysis of ODE IVPs with respect to the parameters p \u2208 RNpi.e., problems of the form,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "2.2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "IDA and IDAS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 124, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u02d9y = f (t,y,p),"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 100, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "y(t0) = y0(p)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 120, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "IDA targets the more general case of DAE and implicit ODE IVPs in the form"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "F (t,y, \u02d9y) = 0,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 102, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "y(t0) = y0,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u02d9y(t0) = \u02d9y0."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 114, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The state is evolved using variable order and variable step size BDF methods in ixed-leading-coeicient form"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[12] of order q = 1, . . . , 5 given by,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 94, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "q"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 94, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u03b1n,iyn\u2212i = hn \u02d9yn."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 34, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "As with CVODES and CVODE, IDAS is an extension to IDA with forward and adjoint sensitivity analysis capabilities for DAE and implicit ODE IVPs of the form"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 8}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "2.3"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ARKODE"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 124, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "F (t,y, \u02d9y,p) = 0,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 98, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "y(t0) = y0(p),"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u02d9y(t0) = \u02d9y0(p)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 122, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The ARKODE package targets ODE IVPs in the linearly-implicit form"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "M(t) \u02d9y = f (t,y), "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "y(t0) = y0,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 3372, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "where for any t, M(t) : RN\u2192 RNis a nonsingular linear operator. In many uses cases M(t) is the identity matrix while in inite element computations it is an N \u00d7 N mass matrix (or a function for its action on a vector). ARKODE supplies two classes of methods where the right-hand side function may be additively partitioned as f (t,y) = f1(t,y) + f2(t,y)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "For stif, nonstif, and mixed stif/nonstif problems, where f1 = fEmay contain the nonstif components, which will be integrated using an explicit method, and f2 = fIthe stif components, which will be integrated implicitly, ARKODE provides explicit, implicit, and implicit-explicit (IMEX) additive Runge-Kutta methods [6, 7, 50, 51] with the general form"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 208}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "zi = yn\u22121 + hn"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 20, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "i\u22121"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "AE i,j\u02c6f E (tn\u22121 + cE jhn,zj) + hn"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "i\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "AI i,j\u02c6f I (tn\u22121 + cI jhn,zj),"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "i = 1, . . . ,s,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 130, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": []}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "yn = yn\u22121 + hn"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 20, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "s\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffdbE i\u02c6f E (tn\u22121 + cE jhn,zi) + bI i\u02c6f I (tn\u22121 + cI jhn,zi)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": ","}], "style": {"indent": {"TYPE": "CT_Ind", "left": 42, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u02dcyn = yn\u22121 + hn"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 20, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "s\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd \u02dcbE i\u02c6f E (tn\u22121 + cE jhn,zi) + \u02dcbI i\u02c6f I (tn\u22121 + cI jhn,zi)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 48, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Here,\u02c6fE(t,y) = M(t)\u22121fE(t,y) and\u02c6fI(t,y) = M(t)\u22121fI(t,y) convert the IVP from linearly implicit to explicit form, zi are internal method stages, and \u02dcyn is an embedded solution for temporal error estimation. The number of stages s and the coeicients A\u2217\u2208 Rs\u00d7s, b\u2217\u2208 Rs, c\u2217\u2208 Rs, and\u02dcb\u2217\u2208 Rsare given by the explicit and implicit Butcher tables that deine the method and its embedding."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 170, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "For multirate problems, the right-hand side may be split into \u0142slow\u017e components, f1 = fS, advanced with a large step Hn and \u0142fast\u017e components, f2 = fF, advanced with time step, hn \u226a Hn. For such problems, ARKODE"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 92, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "provides multirate ininitesimal step [65\u015b67] and multirate ininitesimal GARK [64] methods. These methods utilize an s-stage Runge-Kutta method where the stages zi are computed by solving (with a possibly diferent method) the auxiliary ODE IVP"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u02d9v(\u03b8) = \u2206ci fF(Ti\u22121 + \u2206ci\u03b8,v(\u03b8)) + r (\u03b8), "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "\u03b8 \u2208 [0,Hn],"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 2506, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "v(0) = zi\u22121,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 5884, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "where Ti = tn + ciHn, \u2206ci = ci \u2212 ci\u22121, and r (\u03b8) is a \u0142forcing function\u017e constructed from evaluations of fS(Tj,zj), j = 1, . . . ,i, that propagates information from the slow time scale. The fast IVP solution is used for the new internal stage i.e., zi = v(Hn)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 176, "right": 152, "hanging": 10}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "2.4 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "KINSOL"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Finally the KINSOL package solves nonlinear systems in root-inding or ixed-point form,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "F (u) = 0"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 84, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "and"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "G(u) = u"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 104, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(1)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 74, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "respectively, where u \u2208 RN, and the functions F and G map RN\u2192 RN. For the root-inding case, KINSOL provides inexact and modiied Newton methods [25, 59] which may optionally utilize a line search strategy [27]. For general ixed-point systems and systems with the special form F (u) = Lu \u2212 N (u) \u21d2 G(u) = u \u2212 L\u22121F (u), where L is a nonsingular linear operator (an N \u00d7 N matrix or a function for its action on a vector) and N is (in general) nonlinear, KINSOL implements ixed-point and Picard iterations un+1 = G(un). The convergence of the iteration may be signiicantly accelerated by optionally applying Anderson's method [1, 75]."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "2.5 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Integrator Nonlinear Systems"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "At each time step the implicit integration methods in CVODE(S), ARKODE, and IDA(S) must solve one or more nonlinear systems i.e.,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 8}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "CVODE: "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "yn \u2212 hn\u03b2n,0f (tn,yn) \u2212 an = 0,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 2558, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ARKODE: "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "zi \u2212 hnAI i,i\u02c6f I (tn\u22121 + cI jhn,zi) \u2212 ai = 0, and"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 2432, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "where a\u2217 is comprised of known data from prior time steps or stages. In adjoint sensitivity computations the "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "IDA: "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "F\ufffdtn,yn,h\u22121 n\ufffdq i=0\u03b1n,iyn\u2212i\ufffd= 0."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "same nonlinear systems are solved in the backward problem while forward sensitivity computations require solving an expanded nonlinear system that includes sensitivity equations. In all cases, these nonlinear systems can be viewed as generic root-inding or generic ixed-point problems and are solved using many of the same methods employed by KINSOL."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Note that in the forward sensitivity case CVODES and IDAS utilize the strategy discussed in [56] where a block diagonal approximation of the combined system Jacobian is used when solving the larger nonlinear system with Newton's method. This decoupling enables reusing the ODE/DAE system Jacobian without additional matrix factorizations or preconditioner setups. CVODES and IDAS leverage this structure to utilize the same nonlinear solvers and linear solver interfaces employed by the non-sensitivity-enabled versions of the integrators."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 168, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNDIALS STRUCTURE"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To implement the above methods for integrating ODEs and DAEs or solving nonlinear systems, one must be able to perform the following actions:"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(1) Compute vector operations e.g., add vectors, compute norms, etc. (2) Solve the nonlinear systems that arise in implicit integration methods."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 372, "right": 2880, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}, {"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 72, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:5"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(3) Solve the linear systems that arise within nonlinear solvers or linearly-implicit ODEs (i.e., mass matrix "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "linear systems)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 372, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(4) Compute matrix operations e.g., to explicitly construct the linear systems when necessary or to compute "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "matrix-vector products."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 372, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "These shared requirements across the packages lead directly to an updated SUNDIALS design, based on the existing N_Vector class and the new SUNMatrix, SUNLinearSolver, and SUNNonlinearSolver classes shown in Figure 1. These classes deine abstract interfaces for performing vector and matrix operations as well as solving linear and nonlinear systems, respectively. All of the packages and the solver interfaces depend on the vector"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 170, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "CVODE"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 456, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "CVODES"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 232, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ARKODE"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 322, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "IDA"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 906, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "IDAS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "KINSOL"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 652, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "N_Vector"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 196, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNMatrix"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 102, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNLinearSolver"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 334, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNNonlinearSolver"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 58, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Interface"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 212, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Interface"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 172, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Interface"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 368, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Interface"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 502, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Fig. 1. An overview of the SUNDIALS packages (CVODE, CVODES, IDA, IDAS, ARKODE, and KINSOL) and the four base classes (N_Vector, SUNMatrix, SUNLinearSolver, and SUNNonlinearSolver)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "interface; however, connections between the other classes depend on the particular derived class and use case e.g., matrix-free linear solvers may accept a NULL matrix object."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "This object-oriented design encapsulates implementation-speciic details behind a set of well deined abstract interfaces for performing mathematical operations. This encapsulation enables writing the SUNDIALS packages purely in terms of generic operations on objects, making them agnostic to the user's particular choice of data structures/layout, method of parallelization, algebraic solvers, etc. Moreover, the design provides lexibility, eases the addition of new features, and maximizes the reuse of shared code. With the new class interfaces discussed in this paper, SUNDIALS packages more seamlessly work with other libraries that provide complementary capabilities for scientiic simulations. For example, SUNDIALS can interoperate with discretization and solver libraries as long as class implementations are provided for interfacing to other library's data structures and, if necessary, solvers."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 168, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.1 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Previous SUNDIALS Interfaces"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "While the vector class has long been a feature of SUNDIALS, this object-oriented approach was not originally applied to matrices or algebraic solvers. Earlier versions of SUNDIALS did clearly separate the linear solvers and matrices from the integrators and nonlinear solvers. However, these interfaces sufered from three primary challenges. First, each SUNDIALS package deined its own unique interface to each linear solver implementation, leading to signiicant code duplication and an unnecessary maintenance burden. Second, since each package had a separate linear solver API, it was not possible to provide a custom or third-party linear solver that could be immediately utilized by all the SUNDIALS packages. For example, a linear solver written for CVODE could not be used by ARKODE without writing additional interface code. Lastly, providing the interface functions and performing some computations required directly accessing private data within the packages, which hindered the ability of the packages to evolve without breaking user code."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 10}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Unlike the linear solvers, earlier versions of SUNDIALS did not separate the nonlinear solvers from the integrators. While the integrator-speciic nonlinear systems could be written in a generic form, the nonlinear"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:6"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 92, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "solvers were embedded within the integrators. As such, each package implemented its own nonlinear solvers and did not provide a means for interfacing with external or user-deined nonlinear solvers leading to duplicated code and inconsistent solver options between the packages. Moreover, the lack of a shared nonlinear solver interface across the integration packages limited their lexibility and increased the software maintenance burden."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To address the challenges presented by the old linear solver interfaces and the absence of a nonlinear solver interface, we completely redesigned the handling of matrices, linear solvers, and nonlinear solvers throughout SUNDIALS. Our speciic goals in this redesign were to:"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 170, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022 Collapse the separate package-speciic linear solver interfaces into a single generic interface, thereby "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "removing redundant code."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 484, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022 Unify the package-speciic nonlinear solver implementations into generic implementations shared across "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "the integrators."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 484, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022 Maintain the ability to provide integrator-speciic controls over linear and nonlinear solvers for performance "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "optimization."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 484, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022 Provide streamlined interfaces with clearly deined base classes (and examples) so users can easily leverage "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "application-speciic or external algebraic solvers."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 484, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.2 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNDIALS Class Implementations"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "All of the SUNDIALS base classes follow the same fundamental design and are deined as a C structure containing a void pointer to the derived class member data, a virtual method table (VMT) implemented as a C structure of function pointers, and a simulation context object which provides proiling and logging capabilities. For example, the new SUNLinearSolver class is deined in  as follows"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 8}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "typedef struct _generic_SUNLinearSolver *SUNLinearSolver; "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "typedef struct _generic_SUNLinearSolver_Ops *SUNLinearSolver_Ops;"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 998, "right": 2880, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "struct _generic_SUNLinearSolver { "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "void *content; "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "/* pointer to member data */ "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNLinearSolver_Ops ops; "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "/* virtual method table "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "*/ "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNContext sunctx; "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "/* simulation context "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "*/ };"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 994, "right": 3600, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Note the base class VMT includes pure virtual functions for which a derived class must provide an implementation, virtual functions the derived class may override, and optional functions that, if non-NULL, the SUNDIALS packages will utilize to improve performance. Thus, the base class pure virtual functions deine the required minimum set of operations for derived classes."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Base class constructors are provided to aid in creating derived classes that are responsible for data allocations and other setup e.g., attaching method implementations to the VMT. In the linear solver case, a function to create a derived class could be implemented approximately as follows"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNLinearSolver MySUNLinearSolver (...) { "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNLinearSolver LS = SUNLinSolNewEmpty(sunctx); /* create the base class */"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 998, "right": 1872, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "LS->content"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 460, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "= my_member_data;"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 230, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "/* set member data ptr"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 398, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "*/"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 150, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "LS->ops ->solve"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 208, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "= my_solve_function;"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 230, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "/* set method pointers"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 398, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "*/"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 150, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "/* ... */ "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "return LS; "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "}"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 992, "right": 7344, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Additionally, base class methods are provided to copy the VMT when cloning objects thus ensuring the method pointers are set correctly. The base constructors and utility methods enable the introduction of new specialized virtual and optional methods aimed at increasing the capability and/or performance of the class with minimal impact on current users. Furthermore, when combined with the new Fortran interfaces discussed in Section 7, these methods enable the creation of custom SUNDIALS class implementations from Fortran."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 8}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ENHANCED VECTOR STRUCTURES"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 114, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 72, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:7"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The SUNDIALS vector class has served an invaluable role in allowing existing codes to rapidly utilize SUNDIALS integrators and solvers, since users needed only to provide an N_Vector implementation to wrap and operate on application-speciic data structures. Over time SUNDIALS has been progressively updated to provide a wider set of N_Vector implementations than the original serial and MPI-parallel versions, and now includes vectors based on OpenMP, Pthreads, CUDA, HIP, SYCL, and RAJA for various forms of on-node parallelism. Additionally, implementations that wrap vector objects from PETSc, hypre, and Trilinos have been added to streamline interfacing with other mathematical libraries. However, as hardware has advanced and become more heterogeneous, the required set of vector operations remained static, and there was not a native vector implementation that supported collecting independent vectors into a single object for partitioning data. Thus we have extended the vector class in two distinct ways:"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 172, "right": 144, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(1) Expanded the set of vector methods to include operations that reduce the number of kernel launches, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "reduce memory accesses, increase arithmetic intensity, and/or minimize parallel communication."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 372, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(2) Added a \u0142many-vector\u017e implementation of the vector base class that enables combining diferent indepen-dent vector instances, each using potentially diferent parallelization approaches targeting distinct pieces of hardware, into a single vector."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 662, "right": 0, "hanging": 290}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4.1 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "New Vector Operations"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Throughout a simulation using SUNDIALS, there exist numerous locations that use the same sets of repeated vector operations. Each of these operations over a vector of length N requires O(N ) loating-point operations and memory accesses. Additionally, for accelerator-based implementations, each vector operation requires a separate kernel launch, and for MPI-based parallel vectors each dot product or norm-like operation requires one MPI_Allreduce call. While the total loating-point work of these sequences of vector operations has remained unchanged, we have now reduced these auxiliary costs (memory accesses, kernel launches, or MPI reductions) by creating a set of \u0142fused\u017e operations that each combine a speciic sequence of operations into a single routine."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 168, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Table 1. Subset of optional fused and vector array operations."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 106, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Description"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 552, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int N_VLinearCombination(int n, realtype* c, N_Vector* X, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "N_Vector z)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 118, "right": 1152, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "n\u22121"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 1266, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "z ="}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 22, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ci Xi"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 18, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int N_VScaleAddMulti(int n, realtype* a, N_Vector x, N_Vector* Y, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "N_Vector* Z)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 118, "right": 432, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Zi = ai x + Yi "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "for i = 0, . . . ,n \u2212 1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 576, "right": 432, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int N_VDotProdMulti(int n, N_Vector x, N_Vector* Y, realtype* d)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 118, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "di = x \u00b7 Yi "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "for i = 0, . . . ,n \u2212 1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 576, "right": 432, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int N_VLinearSumVectorArray(int n, realtype a, N_Vector* X, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "realtype b, N_Vector* Y, N_Vector* Z)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 118, "right": 432, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Zi = a Xi + b Yi "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "for i = 0, . . . ,n \u2212 1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 576, "right": 432, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "We group these new operations into two categories. The irst set, shown in the irst three rows of Table 1, fuses standard vector operations into a single operation. The N_VLinearCombination and N_VScaleAddMulti operations replace multiple calls to N_VLinearSum, which computes z = ax + by, with a single call. Similarly, N_VDotProdMulti combines the reductions from several N_VDotProd calls, which compute x \u00b7 y, into a single reduction. The second category is composed of operations on collections of vectors that arise in sensitivity"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:8"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 92, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "analysis simulations. An example is shown in the last row of Table 1 where the linear sum of multiple vectors are computed in one operation."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To minimize the requirements when supplying a custom N_Vector implementation, all of these new operations are optional as the base class implementation calls the pre-existing sequence of required operations to achieve the same result. Thus, the operations can be enabled or disabled at runtime by setting the VMT function pointer to the implementation deined function or to NULL, thereby allowing the user to implement only the operations that are most impactful for their use case. More details on the fused operations and the full set of vector array operations that have been added to the class can be found in [45, Sections 6.1.2 and 6.1.3]."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 168, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "In standalone CPU-based vector tests, we have found that fused streaming operations are beneicial in cases that work on many vectors e.g., with high-order integrators and more than approximately 1,000 unknowns per MPI task. Fused reduction operations arise in orthogonalization methods in iterative methods and are beneicial for any number of vectors and with less than approximately 130K unknowns per MPI task. We note these numbers are machine dependent and will certainly change as architectures advance."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 170, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4.2 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Many-vector"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To enable SUNDIALS packages to leverage heterogeneous computational architectures, increase the ability for asynchronous computation, and enable greater lexibility for multiphysics applications, we have created two \u0142many-vector\u017e N_Vector implementations. These vectors are a software layer to enable operating on a collection of distinct vector instances as if they were a single cohesive vector. The many-vector implementations do not directly manipulate vector data; all computations are carried out by the underlying vector instances. As such, the many-vectors are designed to provide users with more lexibility in the data layout or placement on parallel and heterogeneous architectures, and, in turn, over which resources perform calculations on this data. At a high-level, the design is based on the following objectives:"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 152, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022 Provide a clean mechanism for users to partition their simulation data among disparate computational resources (diferent nodes, diferent compute architectures, diferent types of memory, etc.), enabling \u0142hybrid\u017e computations on heterogeneous architectures."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 432, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022 Facilitate the use of a separate MPI communicator for the collection than is used for any of its subvectors, allowing the higher-level communicator to act as an MPI \u0142intercommunicator\u017e enabling coupled simulations between codes that utilize disjoint MPI communicator groups. From a multiphysics perspective, these disjoint groups can correspond to fully-functioning MPI-based simulations, each using its own standard MPI intracommunicator \u015b the intercommunicator enables messages to be sent between these disjoint simulations."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 662, "right": 144, "hanging": 178}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022 Allow computationally eicient user-supplied routines to perform operations on the relevant subvectors.\u2022 Enable the creation of new SUNDIALS class implementations that leverage the data partitioning (e.g., partitioned integration methods, block (non)linear solvers, etc.) to improve performance for particular application types."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 432, "right": 152, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022 Ensure seamless functionality with any existing SUNDIALS package or class."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 484, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "We envision two non-mutually-exclusive scenarios where the many-vector capability will beneit users (though other use cases are possible): partitioning data between diferent computing resources and combining distinct MPI intracommunicators together into a multiphysics simulation."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "For example, in the data partitioning case on a hybrid CPU+GPU system, a user would create subvectors using existing N_Vector constructors, some of which may be CPU-speciic and others GPU-speciic. In this scenario, it is assumed that all MPI-aware subvectors have been constructed using the same MPI intercommunicator. We note that some of these vectors may represent \u0142independent\u017e portions of the data (e.g., for processes that are not coupled between nodes); these can be constructed out of MPI-unaware N_Vectors, thereby allowing corresponding"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 72, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:9"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "subvector operations to avoid communication altogether. Once all subvectors have been constructed, the user then combines them together into a single many-vector by passing the subvectors to the many-vector constructor. When performing problem-speciic routines (ODE RHS, DAE/nonlinear residual evaluation), the user may then access speciic subvectors to retrieve and ill data, potentially copying data between accelerator and host memory as needed. An illustration of this use case for reactive low is given in Figure 2."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 164, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The multiphysics use case corresponds to users who wish to combine separate simulations together (e.g., for luid-structure interaction or atmosphere-ocean coupling in climate simulations) where it is assumed that MPI-aware subvectors have diferent MPI communicators. Here, we expect that the user will (a) create the MPI intercommunicator that connects the distinct intracommunicators together, and (b) handle communication operations between intracommunicators to couple the physical models together in their problem-deining nonlinear residual or ODE right-hand side routines. As in the data partitioning case, the user creates each of the subvectors and the intercommunicator that couples these together. The unifying many-vector is then constructed by providing the subvectors and intercommunicator to the many-vector constructor."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "We further note that combinations of these two use cases are also possible via the many-vector interface. Additionally, a many-vector may be constructed using many-vectors as subvectors, thereby allowing a hierarchy of communication patterns within a simulation."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 208}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To achieve the above objectives, the MPIManyVector implementation of an N_Vector consists of a relatively lean data structure comprised primarily of an array of subvectors, the global vector length (the combined length of all subvectors for use in RMS-like norms), and an MPI communicator for global reduction operations. In support of these many-vector modules a new required operation, N_VGetLength, and a new optional opera-tion, N_VGetCommunicator, have been added to the set of vector operations. Additionally, to minimize parallel communication with the MPIManyVector, we have expanded the set of optional vector operations to include local reduction kernels so that norm-like calculations may be performed with only a single MPI_Allreduce call (instead of one for each subvector). These methods compute only the portions of a reduction operation that are local to a given subvector and MPI rank, and their results are combined by the MPIManyVector into the overall result. As these local operations are optional, if they are not supplied by a user-provided subvector, then the MPIManyVector implementation will instead compute the inal result using the original (required) vector operations (with the corresponding increase in MPI reductions)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Fig. 2. Example illustration of the data partitioning many-vector use case for a reactive flow simulation. The full state, w, is composed of subvectors for the fluid variables and chemical species. The fluid quantities (density, \u03c1, momentum in the x, y, and z directions, m\u2217, and total energy, et ) are stored as parallel vectors each connected by their own communicator. The chemical species, c, for local reactions are stored in separate task-specific vectors e.g., one or more serial, OpenMP, or GPU vectors per task."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 170, "right": 154, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:10"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 86, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "For example consider the weighted root-mean-square (WRMS) norm of a vector x with weight vector w, both of length N, given by"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2225\u2225"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 596, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "N \u22121"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "()2."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 14, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "xwrms ="}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 12, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "N"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "wixi"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 68, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "In the many-vector case, x and w above are replaced with X and W comprised of s subvectors of length Nj with"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "the total length Ns =\ufffds\u22121 j=0Nj. The WRMS norm is now given as"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 94, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 4956, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "s\u22121 Nj\u22121"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 4022, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2225X \u2225wrms =\ufffdNs 1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 4734, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd\ufffd\ufffdWj,iXj,i\ufffd2."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 3050, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The MPIManyVector algorithm for computing the WRMS norm is given in Algorithm 1. Here we note the use of 1 versus s + 1 global reductions (each WRMS_Norm call requires an MPI_Allreduce). The full set of these optional local reduction operations can be found in [45, Section 6.1.4]."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 170, "right": 174, "hanging": 2}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Algorithm 1: MPIManyVector weighted root-mean-square (WRMS) norm implementation"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 266, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1 local_sum = 0"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 202, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "2 foreach subvector pair Xj, Wj do"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 202, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3 "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "4 "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "5 "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "6 "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "7 "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "8 "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "9 "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "10 "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "11"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 144, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "if local squared sum method exists then "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "local_sum += Local_Squared_Sum(Xj, Wj) "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "else "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "contrib = WRMS_Norm(Xj, Wj) "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "if subvector root task then "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "subvec_length = Get_Length(Xj) "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "local_sum += contrib * contrib * subvec_length"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 220, "right": 2016, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "end"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 526, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "end"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 220, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "12 end "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "13 MPI_Allreduce(&local_sum, &global_sum, 1, MPI_DOUBLE, MPI_SUM, inter_comm)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 130, "right": 2016, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "14 return sqrt(global_sum / global_vec_length)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 130, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4.3"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 8, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "MPI+X"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 124, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "An added beneit of the MPIManyVector implementation is the ability for users to easily create hybrid MPI+X vectors where \u0142X\u017e is a type of on-node parallelism. Given an MPI-unaware on-node vector, either one provided with SUNDIALS (e.g., OpenMP, CUDA, RAJA, etc.) or one deined by the user (e.g., OpenCL, OpenACC, etc.), an MPI+X version of the vector can be simply created by supplying an MPI communicator and the on-node N_Vector to the MPIManyVector constructor. To streamline this particularly beneicial use case we have created an \u0142MPIPlusX\u017e vector, which is a thin wrapper of the MPIManyVector to simplify construction and provide some helpful utility functions for working with the wrapped on-node vector. See [11] for a performance comparison of various GPU on-node vectors beneath the MPIPlusX vector."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 144, "hanging": 2}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "5"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "LINEAR SOLVERS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 114, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 66, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:11"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The new SUNLinearSolver class serves to streamline the use of problem-speciic and third-party linear solvers while maintaining support for integrator-speciic linear solver optimizations within SUNDIALS. To implement a custom SUNLinearSolver, a minimum set of required functions must be implemented. Additionally, there are a variety of optional routines that, if provided, can be leveraged by the SUNDIALS integrators to improve eiciency. There are two required SUNLinearSolver methods: SUNLinSolGetType and SUNLinSolSolve (see Table 2). The irst of these allows the solver to self-identify its \u0142type\u017e as being either: (a) matrix-based and"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 174, "firstLine": 2}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Table 2. Required SUNLinearSolver operations"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 106, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Description"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 662, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNLinearSolver_Type SUNLinSolGetType(SUNLinearSolver LS)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 120, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Returns the solver type"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNLinSolSolve(SUNLinearSolver LS, SUNMatrix A, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "N_Vector x, N_Vector b, realtype tol)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 118, "right": 576, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Solves the linear system Ax = b"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 662, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "direct, (b) matrix-based and iterative, (c) matrix-free and iterative, or (d) matrix-embedded. This identiication allows the SUNDIALS packages to exploit certain solver properties for eiciency. For example, with matrix-based linear solvers the SUNDIALS integrators will infrequently update Jacobian matrices and, for direct linear solvers, matrix factorizations, to amortize the high cost of these operations across multiple time steps or nonlinear solver iterations. Similarly, for iterative linear solvers all of the SUNDIALS packages select tolerances that are \u0142just tight enough\u017e to aid an outer Newton iteration without performing unnecessary linear iterations. The purpose of the second required routine, SUNLinSolSolve, is self-explanatory \u015b this performs the solve for a given linear system Ax = b."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To support integrator-speciic optimizations, the SUNLinearSolver class deines a number of additional \u0142set\u017e routines that, if implemented, can be called to provide more ine-grained control over the SUNLinearSolver object. In addition, a set of \u0142get\u017e routines for retrieving artifacts (statistics, residual vectors, etc.) from the linear solver can also be called. While the SUNDIALS documentation provides an exhaustive list of these set and get routines [45, Section 8.1], we discuss a few of these optional operations (see Table 3) here to highlight their beneits in the SUNLinearSolver class."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Table 3. Subset of optional SUNLinearSolver operations"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 106, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Description"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNLinSolSetup(SUNLinearSolver LS, SUNMatrix A)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 118, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Performs"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 76, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "infrequent"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "solver"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "setup actions"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 1816, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNLinSolSetATimes(SUNLinearSolver LS, void* A_data , "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "ATimesFn ATimes)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 576, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Provides the solver with a rou-tine to compute the product"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 576, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Ax \u2192 z"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 2226, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNLinSolSetScalingVectors(SUNLinearSolver LS, "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "N_Vector s1, N_Vector s2)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 576, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Provides the solver with linear system scaling vectors"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 702, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The amortization of potentially high cost matrix factorizations or preconditioner setups is achieved by calling the optional SUNLinSolSetup function with an updated system matrix A (for matrix-based linear solvers). The"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:12"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 86, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "frequency of these calls depends on the type of integrator and/or nonlinear solver that uses the linear solver, and that frequency may, in many cases, be modiied by the user. However, if this setup routine is not implemented by the SUNLinearSolver, then these costs must instead be incurred at every call to SUNLinSolSolve, which happens much more frequently. To facilitate the linear solver abstraction for matrix-based linear solvers we have created a new SUNMatrix class. This matrix class provides continued support for our pre-existing dense, banded, and sparse-direct linear solvers, and it streamlines interfacing with external linear solver packages."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 168, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "All matrix-based SUNLinearSolver implementations must have a compatible SUNMatrix implementation that provides routines to clone or destroy existing SUNMatrix objects, although some SUNDIALS packages require additional matrix operations for compatibility (see Table 4). The set of SUNDIALS-provided SUNMatrix implementations, as well as their compatibility with provided N_Vector and SUNLinearSolver implementations, is discussed in detail in the SUNDIALS documentation [45, Section 7.1]."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Table 4. Subset of SUNMatrix operations: (R) are required, (O) are optional"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 106, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Description"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 2858, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNMatrix SUNMatClone(SUNMatrix A)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 538, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(R) Allocates a new matrix with the same size and structure as A"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 936, "right": 432, "hanging": 6}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "void SUNMatDestroy(SUNMatrix A)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(R) Frees all memory associated with A"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 1064, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNMatrix_ID SUNMatGetID(SUNMatrix A)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 538, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(O) Identiier used by SUNLinearSolvers to check for compatibility"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 812, "right": 432, "hanging": 6}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNMatCopy(SUNMatrix A, SUNMatrix B)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(O) Copies all values from A into B"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 524, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNMatScaleAddI(realtype c, SUNMatrix A)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "(O) Performs the combination A \u2190 cA + I"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 524, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "For matrix-free iterative linear solvers, the SUNLinearSolver object requires knowledge of the linear system that must be solved. As such, linear solvers having this type must implement the SUNLinSolSetATimes routine, that is called by SUNDIALS packages to provide a function and corresponding data structure for computing the matrix-vector product, Ax \u2192 z."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Lastly, for both matrix-based and matrix-free iterative solvers, the SUNLinearSolver class deines a set of routines to support both scaling and preconditioning, to balance the error between solution components, and to accelerate convergence of the linear solver. To this end, instead of solving a linear system Ax = b directly, iterative SUNLinearSolver implementations may consider the transformed system \u02dcA \u02dcx =\u02dcb, where"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u02dcA = S1P\u22121 1AP\u22121 2S\u22121 2,"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "\u02dcb = S1P\u22121 1b,"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "\u02dcx = S2P2x, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "(2)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 2578, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "and where P1 is the left preconditioner, P2 is the right preconditioner, S1 is a diagonal matrix of scale factors for P\u22121 1b, and S2 is a diagonal matrix of scale factors for P2x. The SUNDIALS integrators provide these scaling matrices such that S1P\u22121 1b and S2P2x have dimensionless components. Furthermore, SUNDIALS packages request that iterative linear solvers stop based on the 2-norm of the scaled preconditioned residual meeting a prescribed tolerance:"}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "\ufffd\ufffd\ufffd \u02dcb \u2212 \u02dcA \u02dcx\ufffd\ufffd\ufffd2 < tol."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "These preconditioning operators and scaling matrices are provided to iterative SUNLinearSolver objects through the optional SetPreconditioner and SetScalingVectors routines. However, if an iterative linear solver imple-mentation does not support scaling, the SUNDIALS packages will attempt to accommodate for the lack of scaling"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 144, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 66, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:13"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "by instead requesting that the iterative linear solver stop based on the criterion"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\ufffd\ufffd\ufffdP\u22121 1b \u2212 P\u22121 1Ax\ufffd\ufffd\ufffd2< tol\ufffds1, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "(3)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 3520, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "where s1 is the RMS norm of the diagonal of S1. This tolerance adjustment is not a perfect replacement for both"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "solution and residual scaling, in that it only accounts for the magnitude of the overall linear residual and does not balance error between speciic residual or solution components."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "With this SUNLinearSolver class in place, our redesign operated on two levels. On the SUNDIALS package side, we converted each linear solver interface to utilize generic linear solvers and leverage the three aforementioned types. On the solver side, we converted each existing linear solver in SUNDIALS to an implementation of the SUNLinearSolver class. We note that through the deinition and use of these abstract classes alone, we were able to remove nine duplicate linear solver interfaces and three utility iles in each of the SUNDIALS packages, while simultaneously expanding the set of linear solvers available for each package and maintaining integrator-speciic eiciency enhancements. The current set of SUNDIALS-provided SUNLinearSolvers includes direct solvers for dense (native, LAPACK [2], MAGMA [73], and oneMKL [46]), banded (native and LAPACK), and sparse (KLU [23, 24], SuperLU_MT [26], SuperLU_Dist [54], and cuSOLVER [58]) matrix-based linear systems, as well as an ensemble of matrix-free scaled-preconditioned iterative linear solvers (GMRES, FGMRES, TFQMR, BiCG-Stab, and CG)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 208}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNLinearSolver Demonstration Problem"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To demonstrate the ability for users to supply a custom linear solver for their applications, we consider the two-dimensional heat equation"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2202"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "\u2202t u(t,x,y) = \u2207 \u00b7 (D\u2207u(t,x,y)) + b(t,x,y)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 2954, "right": 2880, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Here,u is the temperature, D is the diagonal matrix of difusion coeicients (the identity matrix in the experiments below) and the external forcing term b(t,x,y) is given by"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "b(t,x,y) = \u2212 2\u03c0 sin2(\u03c0x) sin2(\u03c0y) sin(\u03c0t) cos(\u03c0t)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 2180, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2212 D1,12\u03c02(cos2(\u03c0x) \u2212 sin2(\u03c0x)) sin2(\u03c0y) cos2(\u03c0t)"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "\u2212 D2,22\u03c02(cos2(\u03c0y) \u2212 sin2(\u03c0y)) sin2(\u03c0x) cos2(\u03c0t)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 3024, "right": 2160, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The problem is solved on the unit square (x,y) \u2208 [0, 1]2for t \u2208 [0, 1] with u(t,x,y) = 0 on the boundary, and the initial condition is u(0,x,y) = sin2(\u03c0x) sin2(\u03c0y). With this coniguration, the problem has the analytical solution u(t,x,y) = sin2(\u03c0x) sin2(\u03c0y) cos2(\u03c0t)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 174, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Spatial derivatives are discretized using second order centered inite diferences with data distributed over an nx \u00d7 ny uniform spatial grid decomposed across a two-dimensional Cartesian communicator with px \u00d7 py MPI tasks. We integrate this problem in time using both CVODE and ARKODE; the ARKODE version of the problem uses the default third order diagonally implicit Runge-Kutta method in ARKODE, while the CVODE version uses adaptive order BDF methods. For both examples, the implicit systems(s) in each time step are solved using SUNDIALS' default inexact Newton method with custom SUNMatrix and SUNLinearSolver implementations that wrap a structured grid matrix and iterative linear solvers from hypre, CG and GMRES. The linear solvers are preconditioned with hypre's PFMG parallel semicoarsening multigrid solver [8, 31]. The source iles for the CVODE and ARKODE versions of this example problem are  and  respectively."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 164, "firstLine": 208}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The member data for the custom SUNMatrix object consists of the Hypre5ptMatrixContent structure that holds the hypre structured grid, stencil, and matrix objects as well as workspace arrays and other information"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:14"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 86, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Table 5. Integrator statistics from the SUNLinearSolver demonstration problem. The MF and JV columns correspond to SUNDIALS solvers with a matrix-free or a user-defined Jacobian-vector product, respectively. The statistics given are the number of successful time steps (Steps), failed time steps (Step fails), total (integrator + linear solver) ODE right-hand side evaluations (RHS evals), nonlinear iterations (NLS iters), and linear iterations (LS iters). The max error at the final time (Error) and the total average run time across 100 runs (Run time) are also given."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 164, "hanging": 4}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNDIALS v6.2.0"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNDIALS v2.7"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "CVODE"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 20, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ARKODE"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 20, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "CVODEa"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ARKODEb"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "CG"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "hypre"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 106, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 100, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "hypre"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 112, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "MF"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 152, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "JV"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "MF"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 164, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "JV"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "MF"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "MF"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Steps"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "84"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 134, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "84"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 62, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "84"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 188, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "148"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 58, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "144"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "144"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u015b"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "144"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Step fails"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 180, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 108, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 234, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 152, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u015b"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "RHS evals"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "109"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 86, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "609"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 16, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "109"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 142, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1,053"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "5,253"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1,018"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u015b"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "5,250"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "NLS iters"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "106"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 86, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "106"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 16, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "106"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 142, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "451"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 58, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "435"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "435"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u015b"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "435"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "LS iters"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "449"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 86, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "500"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 16, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "500"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 142, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4,276"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4,235"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4,236"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u015b"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4,231"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Error (\u00d710\u22127)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 112, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 40, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 166, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4.0"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 84, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.5"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.5"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u015b"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.7"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Run time (sec)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "8.9"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 112, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "13.0"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "9.4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 166, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "67.6"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 36, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "104.4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "71.5"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u015b"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "106.5"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "GMRES"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "hypre"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 106, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 100, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "hypre"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 112, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUN"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "MF"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 152, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "JV"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "MF"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 164, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "JV"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "MF"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "MF"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Steps"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "84"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 134, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "80"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 62, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "80"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 188, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "147"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 58, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "144"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "144"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "80"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "144"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Step fails"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 180, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 108, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 234, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 152, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "RHS evals"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "109"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 86, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "531"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 16, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "104"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 142, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1,042"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "5,193"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1,018"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "532"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "5,196"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "NLS iters"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "106"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 86, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "101"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 16, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "101"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 142, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "446"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 58, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "435"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "435"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "101"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "435"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "LS iters"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "394"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 86, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "427"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 16, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "427"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 142, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4,014"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4,175"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4,174"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "427"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "4,177"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Error (\u00d710\u22127)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 112, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "11.1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "11.1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 120, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.8"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 84, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.6"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.6"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "11.1"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "3.7"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Run time (sec)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "8.3"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 112, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "12.5"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "9.4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 166, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "68.0"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 36, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "110.4"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "79.7"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "12.5"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "109.7"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "a An interface to CG from CVODE is not available in SUNDIALS v2.7.0 "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "b A patch is required to correct the norm used to test for CG convergence in SUNDIALS v2.7.0."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 1242, "right": 1872, "firstLine": 2}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "for updating the matrix entries. A similar structure (HypreLSContent) deines the member data for the SUN-LinearSolver. Since the linear solver is an iterative method that uses a matrix object, the custom SUNMatrix implementation only needs to deine the GetID, Clone, Destroy, Copy, and ScaleAddI methods from Table 4. The custom linear solver deines the required GetType and Solve methods as well as the optional Setup method to enable reusing the preconditioner setup. Additionally, the custom linear solver implementation provides the optional NumIters and Free methods for retrieving the number of iterations from a solve and deallocating the SUNLinearSolver and its content."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Since this custom solver does not provide a function to set scaling vectors, the integrators adjust the linear solve tolerance, as shown in (3). The main function for each example creates SUNMatrix and SUNLinearSolver instances using the custom constructors, Hypre5ptMatrix and HypreLS, respectively. Both of these constructors setup the object as outlined in Section 3. Once the matrix and linear solver objects are created, the example programs attach the objects to the integrators with the ARKODE and CVODE SetLinearSolver functions."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 170, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 66, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:15"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The updated linear solver interfaces make it easy to quickly compare multiple solvers and integrators on a problem. Results comparing the CG and GMRES linear solvers from SUNDIALS (matrix-free or with a user-supplied Jacobian-vector product function) and hypre (matrix-based), each preconditioned with PFMG, underneath a linear multistep integrator (CVODE) and a multistage integrator (ARKODE) are given in Table 5. See the iles  and  for the versions of this example that use the SUNDIALS linear solvers. Additionally, Table 5 includes results from SUNDIALS v2.7.01before the introduction of the new SUNLinearSolver class to illustrate that solver performance is unafected by the new infrastructure (i.e., run times are within the observed run time variability of \u223c2% on the machine). As only ARKODE had an interface to the SUNDIALS CG solver before the introduction of the linear solver class, results with CVODE from SUNDIALS v2.7.0 only utilize the SUNDIALS matrix-free GMRES implementation."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The tests use a 4,096 \u00d7 4,096 spatial grid distributed across 256 MPI tasks (16 tasks each in the x- and y-directions) and are run on 8 nodes of the Quartz cluster at Lawrence Livermore National Laboratory. Each compute node is composed of two Intel Xeon E5-2695 v4 chips, each with 18 cores. MPI tasks are distributed equally across the compute nodes so that 32 of the 36 cores available on a node are utilized. All integrator and solver options are set to the default values and have not been optimized for this example demonstrating the re-usability of class implementations."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "In this example, as seen from Table 5, the combination of CVODE and a matrix-based linear solver from hypre produces the most eicient results for the desired accuracy (the integrator relative and absolute tolerances are 10\u22125and 10\u221210respectively). CVODE is well suited to this problem as it only requires one nonlinear solve per step, regardless of the method order, and adapts the order in addition to the time step size to maximize eiciency. ARKODE also adapts the step size, but uses a ixed order method which requires multiple implicit solves per step (for a problem better suited to the multistage IMEX methods in ARKODE see the 1D advection-reaction problem in Section 6). With the default parameters, the matrix-based hypre solvers lead to faster run times than the SUNDIALS solvers. The increased cost in the matrix-free case is a result of the additional right-hand side evaluations (and the corresponding MPI communication) required to approximate the Jacobian-vector product. Supplying a user-deined Jacobian-vector product function eliminates this cost. However, the SUNDIALS solvers still require approximately 0.5 more linear iterations per nonlinear iteration. The lower average number of iterations with hypre solvers is, in part, due to the tolerance adjustment (3) for linear solvers that do not support scaling. The performance of the SUNDIALS linear solvers can be improved for this problem by relaxing the linear solve tolerance."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Prior to the introduction of the new matrix and linear solver classes, this comparison across diferent integrators, solver options, and parameters would have required the user to implement unique interfaces to hypre solvers for both CVODE and ARKODE. With the new SUNDIALS infrastructure such interfaces can easily be reused between the integrators. Moreover, the user's calling program to setup and evolve the problem in each of these cases is essentially identical. To switch from a native SUNDIALS linear solver to using a hypre solver, the user only needs to swap the SUNDIALS constructor call with a call to their matrix and linear solver constructors and update the SetLinearSolver call to also attach a matrix object. To enable the user-deined Jacobian-vector product, only one additional function call is necessary to attach the user's function. All other linear solver related functions (e.g., adjusting the preconditioner/linear system update frequency or linear solve tolerance) are independent of the choice of SUNLinearSolver object."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "1The implementation of CG in SUNDIALS v2.7.0 incorrectly used a WRMS norm rather than a weighted 2-norm for checking convergence. As such, the results presented are with a patched version of v2.7.0 updated to use the correct norm."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 144, "firstLine": 4}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:16"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "\u2022"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "6 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "NONLINEAR SOLVERS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The new SUNNonlinearSolver class provides an interface for supplying SUNDIALS integrators with problem-speciic and third-party nonlinear solvers. Like the other SUNDIALS base classes, this class deines a set of required and optional methods. Complete descriptions of all SUNNonlinearSolver methods can be found in the SUNDIALS documentation [45, Section 9.1]."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Table 6. Required SUNNonlinearSolver operations"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 106, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Description"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 1956, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNNonlinearSolver_Type"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 120, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Returns the solver type"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 1106, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNNonlinSolGetType(SUNNonlinearSolver NLS)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 706, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNNonlinSolSetSysFn(SUNNonlinearSolver NLS , "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNNonlinSolSysFn SysFn)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 720, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Set a function pointer to the nonlinear system function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 772, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNNonlinSolSolve(SUNNonlinearSolver NLS ,"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 116, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Solves the nonlinear system"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "N_Vector y0, N_Vector ycor , "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "N_Vector w, realtype tol , "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "booleantype callLSetup , void *mem)"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 2378, "right": 4032, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The three required nonlinear solver methods are listed in Table 6. These include the GetType method for querying a solver object about the nonlinear system formulation it expects: root-inding, F (u) = 0, or ixed-point, G(u) = 0. Based on this information, an integrator will use the SetSysFn method to supply the solver with a function to evaluate the appropriate nonlinear system. As nonlinear systems in SUNDIALS integrators are formulated in terms of a correction to the predicted solution, the Solve method is passed the initial guess for the state vector, y0, as well as the correction vector, ycor, which contains the initial correction on input and the inal correction on output. The solution is expected to satisfy the tolerance, tol, in the WRMS norm with weight vector, w. As discussed in Section 5, nonlinear solvers like Newton's method may reuse linear system information between solves to reduce the cost of setting up the linear solver. The input lag, callLSetup, signals whether the linear system matrix and/or preconditioner should be updated."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 164, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Rather than relying directly on the SUNLinearSolver class, the optional SetLSetupFn and SetLSolveFn methods listed in Table 7 allow the integrators to provide the nonlinear solver with functions handling integrator-speciic actions for setting up and solving linear systems. These functions in turn utilize SUNLinearSolver objects. For nonlinear solvers that do not require a linear solver, or the solve is done within the nonlinear solver implementation, these optional methods do not need to be provided. Additionally, the optional SetConvTestFn method listed in Table 7 allows an integrator-speciic convergence test function to be provided. The default stopping test for nonlinear iterations is related to the subsequent local error test for a time step, with the goal of keeping the nonlinear iteration errors from interfering with local temporal error control. In each of the integrators, this test is based on an estimate of the solver convergence rate, and incorporates several heuristics for estimating the rate of convergence and detecting solver divergence. As the default convergence test may not be optimal for all nonlinear solvers or problems, this optional method also allows a user to attach a custom convergence test that is better-suited to the solver or application. Alternately, if the nonlinear solver includes its own internal convergence test, this optional function need not be provided."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "With the new SUNNonlinearSolver class in place, the integrators were updated to utilize generic nonlinear solvers, and the existing solver implementations were combined into shared derived classes. This change greatly"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 66, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:17"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Table 7. Subset of optional SUNNonlinearSolver operations"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 108, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Description"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 488, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNNonlinSolSetLSetupFn(SUNNonlinearSolver NLS , "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNNonlinSolLSetupFn SetupFn);"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 118, "right": 720, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Set linear solver setup function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 488, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNNonlinSolSetLSolveFn(SUNNonlinearSolver NLS , "}, {"TYPE": "Break"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNNonlinSolLSolveFn SolveFn);"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 118, "right": 720, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Set linear solver solve function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 488, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "int SUNNonlinSolSetConvTestFn(SUNNonlinearSolver NLS , "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "SUNNonlinSolConvTestFn CTestFn , void* ctest_data);"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 2632, "right": 432, "hanging": 2514}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Set"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 84, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "convergence"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "test"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": []}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "function"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 488, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "improves the lexibility of the time integrators, as third party nonlinear solver interfaces (e.g., the SUNNonlinear-Solver_PetscSNES class utilizing PETSc's SNES solver [9, 10]), or custom nonlinear solvers (as illustrated below) can now be created."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SUNNonlinearSolver Demonstration Problem"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To demonstrate the lexibility provided by the new nonlinear solver class we consider a one-dimensional advection-reaction problem using a stif variation of the Brusselator model from chemical kinetics [37] utilizing a custom SUNNonlinearSolver. The system is given by"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "hanging": 6}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2202t= \u2212c \u2202u\u2202x+ A \u2212 (w + 1)u + vu2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 1638, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2202t= \u2212c \u2202v\u2202x+ wu \u2212 vu2"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 2428, "firstLine": 0}}}]}]}, {"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2202w"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "\u2202t= \u2212c \u2202w\u2202x+ B \u2212 w"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 1676, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2212 wu"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 52, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "where u, v, and w are chemical concentrations, t \u2208 [0, 10] is time, x \u2208 [0,b] is the spatial variable, c = 0.01 is the advection speed, A = 1 and B = 3.5 are the concentrations of chemical species that remain constant over space and time, and \u03f5 = 5 \u00d7 10\u22126is a parameter that determines the stifness of the system. The problem uses periodic boundary conditions and the initial condition is"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "hanging": 8}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "u(0,x) = A + p(x), "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "v(0,x) = B/A + p(x), "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "w(0,x) = 3.0 + p(x),"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 1810, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "p(x) = 0.1 exp\ufffd\u22122 (2x/b \u2212 1)2\ufffd."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Spatial derivatives are discretized with irst order upwind inite diferences on a uniform mesh with nx points divided across px MPI tasks. The state is stored in a task-local serial vector wrapped by the MPIPlusX vector. The default third order IMEX method from ARKODE is used to evolve the system in time with the advection terms treated explicitly and the reaction terms implicitly."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "As the reactions are purely local in space, the implicit system that must be solved at each stage can be decomposed into independent nonlinear systems at each grid point. To exploit this locality, the user code implements a custom problem-speciic SUNNonlinearSolver to perform MPI task-local solves with the local serial vectors. This eliminates nearly all parallel communication within the implicit solves i.e., global reductions for norms and orthogonalization in GMRES. The only global communication necessary is at the end of the solve phase to check if all the task-local nonlinear solves were successful. The source ile for this example is"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 164, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:18"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 86, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Here, the custom nonlinear solver member data is deined as the TaskLocalNewton_Content structure con-taining an instance of the native SUNDIALS Newton solver and other data for solving the local nonlinear problem. The custom solver deines the required GetType, SetSysFn, and Solve methods as well as the optional methods: SetConvTestFn to use the integrator-provided convergence test function, Free to deallocate the solver, and GetNumConvFails to retrieve the number of solver failures. Additionally, the optional Initialize method is used, in this case, to provide the task-local instance of the SUNDIALS Newton solver with user-deined functions to evaluate the local residual (TaskLocalNlsResidual) and solve the local linear systems (TaskLocalLSolve). The main function creates a solver instance using the custom constructor, TaskLocalNewton, to setup the object as outlined in Section 3. Once the custom solver object is created, the example program attaches it to the integrator with ARKStepSetNonlinearSolver."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 0, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To compare this solution approach with what was possible before the addition of the SUNNonlinearSolver class, the example code provides an option to use the SUNDIALS Newton method to perform a global solve with GMRES as the linear solver and a user-deined, task-local preconditioner. Multiple tests are run with a ixed spatial resolution, b/nx = 10\u22123, and the domain size is increased with the number of MPI tasks; speciically we test with b \u2208 {1, 2, 4, 8, 16, 32, 64, 128, 256} and px \u2208 {40, 80, 160, 320, 640, 1280, 2560, 5120, 10240} with 40 MPI tasks per compute node on the Lassen supercomputer at Lawrence Livermore National Laboratory. Note the results below utilize only the CPUs (two IBM Power9 processors with 44 cores total) on Lassen. For results utilizing GPU acceleration and the MPIPlusX vector with various GPU task-local vectors see [11]."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 170, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Fig. 3. Speedup results for various problem sizes for the SUNNonlinearSolver demonstration problem using a custom task-local nonlinear solver (red squares) and a global Newton solve (blue circles). Execution times are the average of 20 runs and each task-local solver data point is annotated with the approximate speedup achieved compared to the global solver."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Execution times for the global and task-local solvers are given in Figure 3. Although the reduction in synchro-nizations does not signiicantly impact the problem scaling, the custom solver results in speedups of 4x to more than 7x. As such, it is clear that the new nonlinear solver class provides important new capabilities that were not possible before the lexibility enhancements and can lead to signiicantly more eicient solver approaches by exploiting problem structure."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "7 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "FORTRAN 2003 INTERFACES"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Fortran has historically been heavily used in scientiic computing and remains widespread today. As such, although SUNDIALS is written in C, Fortran interfaces have been provided for many years. These Fortran 77 standard compliant interfaces have allowed Fortran users to access a subset of features from CVODE, IDA, ARKODE, and KINSOL and a limited number of the vector, matrix, and solver class implementations available to C/C++ users. While the Fortran 77 interfaces provided access to some SUNDIALS capabilities they also sufered from limited lexibility and sustainability. Notably, the lack of derived types in Fortran 77 was incompatible with SUNDIALS classes, and circumventing this limitation required accessing SUNDIALS classes using global memory, rendering the Fortran 77 interfaces non-threadsafe. As a result, it was diicult for Fortran users to supply application-speciic data layouts or custom solvers, and it was impossible to use multiple instances of SUNDIALS packages simultaneously in a multithreaded environment. Furthermore, maintaining these interfaces required signiicant manual upkeep of code to \u0142glue\u017e the interfaces to C; thus, the Fortran 77 interfaces were not sustainable in the long-term."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "To address these limitations, we have introduced new Fortran 2003 standard compliant interfaces that provide access to all of the features in all six of the SUNDIALS packages (access to CVODES and IDAS were previously unsupported from Fortran 77) as well as most of the core class implementations. These new interfaces are"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 168, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 66, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:19"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "generated automatically using the SWIG-Fortran [48] tool, which only requires minimal additional interface code, much of which is common across SUNDIALS, to create bindings using the Fortran 2003 features for interoperability with ISO C code. When the C API changes in any package or class with an existing Fortran 2003 interface, the SWIG-Fortran tool is run, and the interface \u0142glue\u017e code is regenerated before package release. This process its nicely into a modern software development worklow and could be further automated to run as part of a continuous integration/continuous delivery pipeline. Thus, the Fortran 2003 interfaces have a low-maintenance cost and can quickly be extended to support new features and class implementations as they are added i.e., the Fortran 2003 interfaces are sustainable."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 170, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Since the Fortran 2003 interfaces are based on features of the Fortran 2003 standard for interopability with ISO C code, they allow Fortran users to continue to write idiomatic Fortran with few caveats, but to then interact with SUNDIALS in a way that closely resembles the C API. In fact, the Fortran 2003 interface API is close enough to the C API that the C API documentation serves dual-purpose as the Fortran 2003 documentation, modulo some information on data types and subtleties attributed to inherent diferences of C and Fortran. Function signatures match the C API with an \u0142F\u017e prepended to the function name e.g., FN_VConst instead of N_VConst. The generic SUNDIALS classes, such as the N_Vector, are interfaced as Fortran derived-types of the same name. This convention means that users can easily provide custom, application-speciic implementations of the generic SUNDIALS classes that are written entirely in Fortran (as illustrated below). Data arrays (e.g., real arrays ) are interfaced as Fortran arrays of the corresponding type deined in the iso_c_binding intrinsic module. The exact mapping of SUNDIALS C types to Fortran 2003 types, as well as discussion of subtle usage diferences between the C and Fortran 2003 APIs, is given in the SUNDIALS documentation [45, Section 5.1]."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Fortran 2003 Interface Demonstration Problem"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "A second version of the demonstration problem from Section 6 utilizing a custom nonlinear solver is also implemented in Fortran. The source code for this version of the problem is . As the Fortran interface closely mirrors the C API, the same steps to create a derived class implementation apply to the Fortran use case."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 164, "hanging": 8}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "In this example, all of the data needed by the custom task-local nonlinear solver is contained in a user-deined module, nls_mod. As such, the data is efectively global (albeit namespace protected). An alternative, thread safe approach would be to deine a new type for the solver data and attach it as the class member data. In this case, the module includes an instance of the SUNDIALS Newton method and other data needed for solving the task-local nonlinear systems as well as functions implementing required and optional nonlinear solver methods. An instance of the nonlinear solver object is created using the constructor subroutine TaskLocalNewton which leverages the corresponding base class constructor to create a SUNNonlinearSolver object and c_funloc to set the function pointers in the VMT. In this case, the object's content ield does not need to be set as all the data needed by the solver is accessible through the nls_mod module. Once the solver and all its required data are created, the nonlinear solver object is attached to the integrator with the FARKStepSetNonlinearSolver function. As expected, the C and Fortran versions of the problem have the same integrator and solver statistics and nearly identical run times."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 144, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "8 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "CONCLUSIONS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The growing complexity of scientiic simulations and recent advances in high performance computing systems have resulted in increased demand for utilizing new programming models and more varied algebraic solver options with the SUNDIALS time integrators and nonlinear solvers. To meet these demands, we have created new matrix, linear solver, and nonlinear solver classes following the same object-oriented design previously utilized by the SUNDIALS vector. These new additions adhere to a number of guiding principles that provide"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 168, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:20"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 86, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "greater lexibility while increasing the sustainability of the SUNDIALS packages, requiring minimal changes to user codes, and resulting in signiicant performance beneits in many situations."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The new classes allow for easier interoperability with and reuse of external and application-speciic data structures and solvers across SUNDIALS packages. In particular, the encapsulation of the nonlinear solvers from the time integrators provides lexibility in nonlinear solution approaches that was not previously available in SUNDIALS. Additionally, we have expanded the SUNDIALS vector class implementations to include a new many-vector capability, allowing for a vector comprised of various subvectors. This many-vector construct provides an easy way to accommodate multiphysics simulations as well as heterogeneous architectures where diferent vectors operate on data residing in potentially diferent memory spaces. An MPI+X vector was further added on top of the many-vector to streamline the introduction of new vectors supporting various approaches to on-node parallelism with heterogeneous computing platforms. New fused operations better utilize available hardware and enable development of reduced communication algorithms. Lastly, modern Fortran interfaces allow full access to the lexibility provided with the SUNDIALS classes."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 166, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Numerical tests have shown that the new infrastructure retains the existing behavior of the time integrators and does not increase the cost of simulations. Moreover, the results demonstrate the power of being able to easily compare the performance of fundamentally diferent integrators and solver approaches within the same problem. Signiicant speedups were also shown when leveraging the new nonlinear solver class to provide a problem-speciic solver exploiting the structure and locality in the nonlinear system."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 174, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "With these new capabilities in place, future work includes implementing new vectors and matrices to accom-modate more types of on-node parallelism, investigating algorithms that leverage fused operations for greater performance, and expanding the set of native solver interfaces provided with SUNDIALS. Additionally, we plan to leverage the new many-vector implementation within SUNDIALS to exploit the structural features of diferent applications."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 200}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACKNOWLEDGMENTS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "The authors thank Alan Hindmarsh for numerous discussions and insights into details of integrator controls on solvers and design of integrator codes."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "hanging": 6}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "This research was supported by the Exascale Computing Project, (17-SC-20-SC), a collaborative efort of the U.S. Department of Energy Oice of Science and the National Nuclear Security Administration."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Support for this work was provided in part by the U.S. Department of Energy, Oice of Science, Oice of Advanced Scientiic Computing Research, Scientiic Discovery through Advanced Computing (SciDAC) Program through the Frameworks, Algorithms, and Scalable Technologies for Mathematics (FASTMath) Institute."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 166, "right": 174, "firstLine": 208}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "This work was performed under the auspices of the U.S. Department of Energy by Lawrence Livermore National Laboratory under contract DE-AC52-07NA27344. Lawrence Livermore National Security, LLC. LLNL-JRNL-816631."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "REFERENCES"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[1] Donald G. Anderson. 1965. Iterative procedures for nonlinear integral equations. J. ACM 12, 4 (1965), 547\u015b560. "}, {"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[2] E. Anderson, Z. Bai, C. Bischof, S. Blackford, J. Demmel, J. Dongarra, J. Du Croz, A. Greenbaum, S. Hammarling, A. McKenney, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "and D. Sorensen. 1999. LAPACK Users' Guide (third ed.). Society for Industrial and Applied Mathematics, Philadelphia, PA. "}, {"TYPE": "TabChar"}, {"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[3] Robert Anderson, Julian Andrej, Andrew Barker, Jamie Bramwell, Jean-Sylvain Camier, Jakub Cerveny, Veselin Dobrev, Yohann Dudouit, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Aaron Fisher, Tzanio Kolev, et al. 2021. MFEM: A modular inite element methods library. Comput. Math. with Appl. 81 (2021), 42\u015b74."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 248, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[4] Joel A. E. Andersson, Joris Gillis, Greg Horn, James B. Rawlings, and Moritz Diehl. 2019. CasADi \u015b A software framework for nonlinear "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "optimization and optimal control. Math. Program. Comput. 11, 1 (2019), 1\u015b36."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 248, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 66, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:21"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[5] Daniel Arndt, Wolfgang Bangerth, Bruno Blais, Thomas C. Clevenger, Marc Fehling, Alexander V. Grayver, Timo Heister, Luca Heltai, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Martin Kronbichler, Matthias Maier, Peter Munch, Jean-Paul Pelteret, Reza Rastak, Ignacio Thomas, Bruno Turcksin, Zhuoran Wang, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "and David Wells. 2020. The deal.II Library, Version 9.2. J. Numer. Math. 28, 3 (2020), 131\u015b146. [6] Uri M. Ascher, Steven J. Ruuth, and Raymond J. Spiteri. 1997. Implicit-Explicit Runge-Kutta Methods for Time-Dependent Partial "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Diferential Equations. Appl. Numer. Math. 25, 2-3 (Nov 1997), 151\u015b167. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[7] Uri M. Ascher, Steven J. Ruuth, and Brian T. R. Wetton. 1995. Implicit-Explicit Methods for Time-Dependent Partial Diferential Equations."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 248, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SIAM J. Numer. Anal. 32, 3 (1995), 797\u015b823. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[8] Steven F. Ashby and Robert D. Falgout. 1996. A parallel multigrid preconditioned conjugate gradient algorithm for groundwater low "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "simulations. Nucl. Sci. Eng. 124, 1 (1996), 145\u015b159. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[9] Satish Balay, Shrirang Abhyankar, Mark F. Adams, Jed Brown, Peter Brune, Kris Buschelman, Lisandro Dalcin, Alp Dener, Victor Eijkhout, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "William D. Gropp, Dinesh Kaushik, Matthew G. Knepley, Dave A. May, Lois Curfman McInnes, Richard Tran Mills, Todd Munson, Karl "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Rupp, Patrick Sanan, Barry F. Smith, Stefano Zampini, Hong Zhang, and Hong Zhang. 2021. PETSc Web page. https://petsc.org/. [10] Satish Balay, Shrirang Abhyankar, Mark F. Adams, Jed Brown, Peter Brune, Kris Buschelman, Lisandro Dalcin, Alp Dener, Victor Eijkhout, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "William D. Gropp, Dinesh Kaushik, Matthew G. Knepley, Dave A. May, Lois Curfman McInnes, Richard Tran Mills, Todd Munson, Karl "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Rupp, Patrick Sanan, Barry F. Smith, Stefano Zampini, Hong Zhang, and Hong Zhang. 2021. PETSc Users Manual. Technical Report "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "ANL-95/11 - Revision 3.15. Argonne National Laboratory."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[11] Cody J. Balos, David J. Gardner, Carol S. Woodward, and Daniel R. Reynolds. 2021. Enabling GPU Accelerated Computing in the "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNDIALS Time Integration Library. Parallel Comput. 108 (2021), 102836. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[12] Kathryn Eleda Brenan, Stephen L. Campbell, and Linda Ruth Petzold. 1995. Numerical solution of initial-value problems in diferential-"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "algebraic equations. SIAM Publications, Philadelphia, PA. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[13] Peter N. Brown, George D. Byrne, and Alan C. Hindmarsh. 1989. VODE: A variable-coeicient ODE solver. SIAM J. Sci. Statist. Comput."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "10, 5 (1989), 1038\u015b1051. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[14] Peter N. Brown and Alan C. Hindmarsh. 1986. Matrix-free methods for stif systems of ODE's. SIAM J. Numer. Anal. 23, 3 (1986), 610\u015b638."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[15] Peter N. Brown and Alan C. Hindmarsh. 1989. Reduced storage matrix methods in stif ODE systems. Appl. Math. Comput. 31 (1989), "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "40\u015b91. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[16] Peter N. Brown, Alan C. Hindmarsh, and Linda R. Petzold. 1994. Using Krylov methods in the solution of large-scale diferential-algebraic "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "systems. SIAM J. Sci. Comput. 15, 6 (1994), 1467\u015b1488. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[17] Peter N. Brown, Alan C. Hindmarsh, and Linda R. Petzold. 1998. Consistent initial condition calculation for diferential-algebraic systems."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SIAM J. Sci. Comput. 19, 5 (1998), 1495\u015b1512. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[18] Peter N. Brown and Youcef Saad. 1990. Hybrid Krylov methods for nonlinear systems of equations. SIAM J. Sci. Statist. Comput. 11, 3 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "(1990), 450\u015b481. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[19] George D. Byrne and Alan C. Hindmarsh. 1975. A polyalgorithm for the numerical solution of ordinary diferential equations. ACM "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Trans. Math. Software 1, 1 (1975), 71\u015b96. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[20] George D. Byrne and Alan C. Hindmarsh. 1987. Stif ODE solvers: A review of current and coming attractions. J. Comput. Phys. 70, 1 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "(1987), 1\u015b62. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[21] Yang Cao, Shengtai Li, Linda Petzold, and Radu Serban. 2003. Adjoint sensitivity analysis for diferential-algebraic equations: The adjoint "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "DAE system and its numerical solution. SIAM J. Sci. Comput. 24, 3 (2003), 1076\u015b1089. [22] Nicholas T. Carnevale and Michael L. Hines. 2006. The NEURON Book. Cambridge University Press, Cambridge, England. "}, {"TYPE": "TabChar"}, {"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[23] Tim Davis. 2020. KLU Sparse Matrix Factorization Library. http://faculty.cse.tamu.edu/davis/suitesparse.html."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[24] Tim Davis and Ekanathan Palamadai Natarajan. 2010. Algorithm 907: KLU, a direct sparse solver for circuit simulation problems. ACM "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Trans. Math. Software 37, 3 (2010), 36:1\u015b36:17. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[25] Ron S. Dembo, Stanley C. Eisenstat, and Trond Steihaug. 1982. Inexact Newton methods. SIAM J. Numer. Anal. 19, 2 (1982), 400\u015b408."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[26] James W. Demmel, John R. Gilbert, and Xiaoye S. Li. 1999. An Asynchronous Parallel Supernodal Algorithm for Sparse Gaussian "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Elimination. SIAM J. Matrix Anal. Appl. 20, 4 (1999), 915\u015b952. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[27] John E. Dennis, Jr and Robert B. Schnabel. 1996. Numerical methods for unconstrained optimization and nonlinear equations. SIAM "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Publications, Philadelphia, PA. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[28] Milo R. Dorr, J-L Fattebert, Michael E. Wickett, James F. Belak, and Patrice E.A. Turchi. 2010. A numerical algorithm for the solution of a "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "phase-ield model of polycrystalline materials. J. Comput. Phys. 229, 3 (2010), 626\u015b641. [29] B.D. Dudson, M.V. Umansky, XQ Xu, P.B. Snyder, and H.R. Wilson. 2009. BOUT++: A framework for parallel plasma luid simulations."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Comput. Phys. Commun. 180, 9 (2009), 1467\u015b1480. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[30] Edda Eich. 1993. Convergence results for a coordinate projection method applied to mechanical systems with algebraic constraints."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "SIAM J. Numer. Anal. 30, 5 (1993), 1467\u015b1482."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 516, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:22"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "D. J. Gardner, D. R. Reynolds, C. S. Woodward, and C. J. Balos"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 86, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[31] Robert D. Falgout and Jim E. Jones. 2000. Multigrid on massively parallel architectures. In Multigrid Methods VI. Springer, Berlin, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Heidelberg, 101\u015b107. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[32] William F. Feehery, John E. Tolsma, and Paul I. Barton. 1997. Eicient sensitivity analysis of large-scale diferential-algebraic systems."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Appl. Numer. Math. 25, 1 (1997), 41\u015b54. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[33] David J. Gardner, Jorge E. Guerra, Fran\u00e7ois P. Hamon, Daniel R. Reynolds, Paul A. Ullrich, and Carol S. Woodward. 2018. Implicit\u015b "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "explicit (IMEX) Runge\u015bKutta methods for non-hydrostatic atmospheric models. Geosci. Model Dev. 11, 4 (2018), 1497\u015b1515. "}, {"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[34] David J. Gardner, Carol S. Woodward, Daniel R. Reynolds, Gregg Hommes, Sylvie Aubry, and A. Arsenlis. 2015. Implicit integration "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "methods for dislocation dynamics. Modelling Simul. Mater. Sci. Eng. 23, 2 (2015), 025006. [35] David G. Goodwin, Raymond L. Speth, Harry K. Mofat, and Bryan W. Weber. 2018. Cantera: An Object-oriented Software Toolkit "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "for Chemical Kinetics, Thermodynamics, and Transport Processes.  "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Version 2.4.0."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[36] Ernst Hairer, Syvert P. N\u00f9rsett, and Gerhard Wanner. 1993. Solving Ordinary Diferential Equations I: Nonstif Problems (2 ed.). Springer-"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Verlag, Berlin, Heidelberg. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[37] Ernst Hairer and Gerhard Wanner. 1996. Solving Ordinary Diferential Equations II: Stif and Diferential-Algebraic Problems (2 ed.)."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Springer-Verlag, Berlin Heidelberg. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[38] Alan C. Hindmarsh. 1980. LSODE and LSODI, two new initial value ordinary diferential equation solvers. ACM SIGNUM Newslett. 15, 4 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "(1980), 10\u015b11. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[39] Alan C. Hindmarsh. 1983. ODEPACK, a systematized collection of ODE solvers. In Scientiic Computing: Applications of Mathematics and "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Computing to the Physical Sciences (IMACS transactions on scientiic computation, Vol. 1), Robert S. Stepleman, M. Carver, William F. "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Ames, et al. (Eds.). North-Holland, Amsterdam, Netherlands, 55\u015b64."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[40] Alan C. Hindmarsh. 1992. Detecting stability barriers in BDF solvers. In Computational Ordinary Diferential Equations (Institute of "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Mathematics and its Applications Conference Series), J. R. Cash and I. Gladwell (Eds.). Oxford University Press, Oxford, England, 87\u015b96. [41] Alan C. Hindmarsh, Peter N. Brown, Keith E. Grant, Steven L. Lee, Radu Serban, Dan E. Shumaker, and Carol S. Woodward. 2005."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "SUNDIALS: Suite of nonlinear and diferential/algebraic equation solvers. ACM Trans. Math. Software 31, 3 (2005), 363\u015b396. "}, {"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[42] Alan C. Hindmarsh and Syvert P. N\u00f9rsett. 1988. KRYSI, an ODE solver combining a semi-implicit Runge-Kutta method and a preconditioned "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Krylov method. Technical Report. Lawrence Livermore National Laboratory, Livermore, CA (USA); Trondheim Univ. (Norway). [43] Alan C. Hindmarsh and Linda R. Petzold. 1995. Algorithms and software for ordinary diferential equations and diferential-algebraic "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "equations, Part I: Euler methods and error estimation. Comput. Phys. 9, 1 (1995), 34\u015b41. [44] Alan C. Hindmarsh and Linda R. Petzold. 1995. Algorithms and software for ordinary diferential equations and diferential-algebraic "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "equations, Part II: Higher-order methods and software packages. Comput. Phys. 9, 2 (1995), 148\u015b155. [45] Alan C. Hindmarsh, Radu Serban, Cody J. Balos, David J. Gardner, Daniel R. Reynolds, and Carol S. Woodward. 2021. User Documentation "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "for CVODE. v6.2.0."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[46] Intel. 2022. Developer Reference for Intel oneAPI Math Kernel Library. "}, {"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[47] Kenneth R. Jackson and Ron Sacks-Davis. 1980. An alternative implementation of variable step-size multistep formulas for stif ODEs."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "ACM Trans. Math. Software 6, 3 (1980), 295\u015b318. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[48] Seth Johnson, Andrey Prokopenko, and Katherine Evans. 2019. Automated Fortran-C++ Bindings for Large-Scale Scientiic Applications."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Comput. Sci. Eng. PP (2019), 1\u015b1. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[49] Ian Karlin et al. 2019. Preparation and Optimization of a Diverse Workload for a Large-Scale Heterogeneous System. In Proceedings of "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "the International Conference for High Performance Computing, Networking, Storage and Analysis (Denver, Colorado) (SC '19). Association "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "for Computing Machinery, New York, NY, USA, Article 32, 17 pages. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[50] Christopher A. Kennedy and Mark H. Carpenter. 2003. Additive Runge\u015bKutta schemes for convection\u015bdifusion\u015breaction equations."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Appl. Numer. Math. 44, 1-2 (Jan 2003), 139\u015b181. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[51] Christopher A. Kennedy and Mark H. Carpenter. 2019. Higher-Order Additive Runge\u015bKutta Schemes for Ordinary Diferential Equations."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Appl. Numer. Math. 136 (Feb 2019), 183\u015b205. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[52] Stefan J. Kollet, Reed M. Maxwell, Carol S. Woodward, Steve Smith, Jan Vanderborght, Harry Vereecken, and Clemens Simmer. 2010."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Proof of concept of regional scale hydrologic simulations at hydrologic resolution utilizing massively parallel computer resources. Water "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Resour. Res. 46, 4 (2010), 7 pages. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[53] Shengtai Li and Linda Petzold. 2000. Software and algorithms for sensitivity analysis of large-scale diferential algebraic systems. J."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Comput. Appl. Math. 125, 1-2 (2000), 131\u015b145. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[54] Xiaoye S. Li and James W. Demmel. 2003. SuperLU_DIST: A Scalable Distributed-Memory Sparse Direct Solver for Unsymmetric Linear "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Systems. ACM Trans. Math. Software 29, 2 (June 2003), 110\u015b140."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 168, "right": 0, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "CT_Empty", "VALUE": "[w:drawing]"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0}}}, {"TYPE": "table", "VALUE": [{"TYPE": "table-row", "VALUE": [{"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "Enabling New Flexibility in SUNDIALS"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 66, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "\u2022"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}, {"TYPE": "table-cell", "VALUE": [{"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "0:23"}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 0, "firstLine": 0}}}]}]}]}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "[55] Benny Malengier, Pavol Ki\u0161on, James Tocknell, Claas Abert, Florian Bruckner, and Marc-Antonio Bisotti. 2018. ODES: a high level "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "interface to ODE and DAE solvers. J. Open Source Softw. 3, 22 (2018), 165. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[56] Timothy Maly and Linda R. Petzold. 1996. Numerical methods and software for sensitivity analysis of diferential-algebraic systems."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Appl. Numer. Math. 20, 1-2 (1996), 57\u015b79. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[57] Matthew J. McNenly, Russell A. Whitesides, and Daniel L. Flowers. 2015. Faster solvers for large kinetic mechanisms using adaptive "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "preconditioners. Proc. Combust. Inst. 35, 1 (2015), 581\u015b587. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[58] NVIDIA. 2019. cuSOLVER library, release 10.1.243. [59] James M. Ortega and Werner C. Rheinboldt. 2000. Iterative solution of nonlinear equations in several variables. SIAM Publications, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Philadelphia, PA. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[60] Michael Pernice and Homer F. Walker. 1998. NITSOL: A Newton iterative solver for nonlinear systems. SIAM J. Sci. Comput. 19, 1 (1998), "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "302\u015b318. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[61] Linda R. Petzold. 1982. Description of DASSL: A diferential/algebraic system solver. Technical Report. Sandia National Laboratory, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Livermore, CA (USA). "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[62] Christopher Rackauckas and Qing Nie. 2017. DiferentialEquations.jl \u015b A performant and feature-rich ecosystem for solving diferential "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "equations in Julia. J. Open Res. Softw. 5, 1 (2017), 10 pages. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[63] Daniel R. Reynolds, David J. Gardner, Cody J. Balos, and Carol S. Woodward. 2019. SUNDIALS Multiphysics+MPIManyVector Performance "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Testing. Technical Report. Lawrence Livermore National Laboratory. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[64] Adrian Sandu. 2019. A Class of Multirate Ininitesimal GARK Methods. SIAM J. Numer. Anal. 57, 5 (Jan 2019), 2300\u015b2327. "}, {"TYPE": "TabChar"}, {"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[65] Martin Schlegel, Oswald Knoth, Martin Arnold, and Ralf Wolke. 2009. Multirate Runge\u015bKutta schemes for advection equations. J."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Comput. Appl. Math. 226, 2 (Apr 2009), 345\u015b357. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[66] Martin Schlegel, Oswald Knoth, Martin Arnold, and Ralf Wolke. 2012. Implementation of multirate time integration methods for air "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "pollution modelling. Geosci. Model Dev. 5, 6 (Nov 2012), 1395\u015b1405. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[67] Martin Schlegel, Oswald Knoth, Martin Arnold, and Ralf Wolke. 2012. Numerical solution of multiscale problems in atmospheric "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "modeling. Appl. Numer. Math. 62, 10 (Oct 2012), 1531\u015b1543. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[68] Henning Schmidt. 2007. SBaddon: High performance simulation for the Systems Biology Toolbox for MATLAB. Bioinformatics 23, 5 "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "(2007), 646\u015b647. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[69] Radu Serban and Alan C. Hindmarsh. 2005. CVODES: The sensitivity-enabled ODE solver in SUNDIALS. In Proceedings of the ASME "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "2005 International Design Engineering Technical Conferences and Computers and Information in Engineering Conference. (International "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Design Engineering Technical Conferences and Computers and Information in Engineering Conference, Vol. Volume 6: 5th International "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Conference on Multibody Systems, Nonlinear Dynamics, and Control, Parts A, B, and C). American Society of Mechanical Engineers, "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "257\u015b269. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[70] Lawrence F. Shampine. 1999. Conservation laws and the numerical solution of ODEs, II. Comput. Math. with Appl. 38, 2 (1999), 61\u015b72."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[71] The SUNDIALS development team. 2022. SUNDIALS. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[72] The SUNDIALS development team. 2022. SUNDIALS GitHub. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[73] Stanimire Tomov, Jack Dongarra, and Marc Baboulin. 2010. Towards dense linear algebra for hybrid GPU accelerated manycore systems."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 342}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Parallel Comput. 36, 5-6 (June 2010), 232\u015b240. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[74] Christopher J. Vogl, Andrew Steyer, Daniel R. Reynolds, Paul A. Ullrich, and Carol S. Woodward. 2019. Evaluation of Implicit-"}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "Explicit Additive Runge-Kutta Integrators for the HOMME-NH Dynamical Core. J. Adv. Model. Earth Syst. 11, 12 (2019), 4228\u015b4244."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[75] Homer F. Walker and Peng Ni. 2011. Anderson acceleration for ixed-point iterations. SIAM J. Numer. Anal. 49, 4 (2011), 1715\u015b1735."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "TabChar"}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[76] Wolfram. 2020. IDA Method for NDSolve. "}, {"TYPE": "Break"}, {"TYPE": "text", "VALUE": "[77] Weiqun Zhang, Andrew Myers, Kevin Gott, Ann Almgren, and John Bell. 2021. AMReX: Block-structured adaptive mesh reinement for "}, {"TYPE": "TabChar"}, {"TYPE": "text", "VALUE": "multiphysics applications. Int. J. High Perform. Comput. Appl. 35, 6 (2021), 508\u015b526."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 174, "right": 144, "firstLine": 0}}}, {"TYPE": "paragraph", "VALUE": [{"TYPE": "text", "VALUE": "ACM Trans. Math. Softw."}], "style": {"indent": {"TYPE": "CT_Ind", "left": 0, "right": 174, "firstLine": 0}}}]}]}